MACRO

CORREL X Y

MCONSTANT N I SUMX SUMY SUMXY SUMXX SUMYY COR
MCOLUMN X Y

LET N=COUNT(X)
LET SUMX=0
LET SUMY=0
LET SUMXY=0
LET SUMXX=0
LET SUMYY=0

DO I=1:N
	LET SUMX = SUMX+X(I)
	LET SUMY = SUMY+Y(I)
	LET SUMXY = SUMXY + (X(I)*Y(I))
	LET SUMXX = SUMXX + (X(I)^2)
	LET SUMYY = SUMYY + (Y(I)^2)
ENDDO

LET COR=((N*SUMXY)-(SUMX*SUMY))/(SQRT(((N*SUMXX)-(SUMX^2))*((N*SUMYY)-(SUMY^2))))

PRINT COR

ENDMACRO